<?xml version="1.0" encoding="utf-8"?>
<ui:ControlPanel xmlns:mx="http://www.adobe.com/2006/mxml"
				 xmlns:ui="weave.ui.*"
				 width="400" height="300" layout="absolute" title="{lang('InfoMaps Image List')}">
	<mx:VBox width="100%" height="100%">
		<mx:List id="imageList" width="100%" height="100%"/>
		<mx:HBox>
			<mx:Button label="Clear All" click="removeAllImagesButton(event)"
					   enabled="{imageList.dataProvider.length &gt; 0}"/>
			<mx:Button label="Remove selected image" click="removeSelectionButton(event)"
					   enabled="{imageList.dataProvider.length  &gt; 0}"/>
		</mx:HBox>
	</mx:VBox>
	<mx:Script>
		<![CDATA[
			import weave.core.LinkableHashMap;
			
			override protected function childrenCreated():void
			{
				super.childrenCreated();				
			}			
			
			override public function set targets(array:Array):void
			{
				super.targets = array;
				//Populate the list with the image names.
				imageList.dataProvider = (_targetObjects[0] as LinkableHashMap).getNames();
			}
			
			protected function removeSelectionButton(event:MouseEvent):void
			{
				//After making sure something is selected, remove that background image.
				if( _targetObjects != null && imageList.selectedItem != null)
				{
					(_targetObjects[0] as LinkableHashMap).removeObject(imageList.selectedItem as String);
					(_targetObjects[0] as LinkableHashMap).triggerCallbacks();
					imageList.dataProvider = (_targetObjects[0] as LinkableHashMap).getNames();
				}
			}
			
			protected function removeAllImagesButton(event:MouseEvent):void
			{
				//If it hasn't been already cleared, clear all of the images.
				if( _targetObjects != null )
				{
					(_targetObjects[0] as LinkableHashMap).removeAllObjects();
					(_targetObjects[0] as LinkableHashMap).triggerCallbacks();
					imageList.dataProvider = null;
				}
			}
			
		]]>
	</mx:Script>
</ui:ControlPanel>
