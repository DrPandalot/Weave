<?xml version="1.0" encoding="utf-8"?>
<ui:ControlPanel xmlns:mx="http://www.adobe.com/2006/mxml"
				 xmlns:ui="weave.ui.*"
				 width="400" height="300" layout="absolute" title="{lang('Component List')}">	
	<mx:VBox width="100%" height="100%">
		<mx:List id="imageList" width="100%" height="100%"/>
		<mx:HBox>
			<mx:Button label="Clear All" click="removeAllImagesButton(event)"
					   enabled="{imageList.dataProvider.length > 0}"/>
			<mx:Button label="Remove selected item" click="removeSelectionButton(event)"
					   enabled="{imageList.dataProvider.length > 0}"/>
			<mx:Button id="nodeGroupPreferences" label="Adjust Preferences" click="openNodeGroupSettings(event)"
					   enabled="{imageList.dataProvider.length > 0}"/>
		</mx:HBox>
	</mx:VBox>
	<mx:Script>
		<![CDATA[
			import weave.core.LinkableHashMap;
			import weave.ui.DraggablePanel;
			import weave.ui.infomap.layout.InfoMapBackgroundImage;
			
			override protected function childrenCreated():void
			{
				super.childrenCreated();				
			}			
			
			override public function set targets(array:Array):void
			{
				super.targets = array;
				//Populate the list with the object names.
				imageList.dataProvider = (_targetObjects[0] as LinkableHashMap).getNames();
				if( (_targetObjects[0] as LinkableHashMap).getNames(InfoMapBackgroundImage).length > 0 )
					nodeGroupPreferences.visible = false;
				else
					nodeGroupPreferences.visible = true;
			}
			
			protected function removeSelectionButton(event:MouseEvent):void
			{
				//After making sure something is selected, remove that object.
				if( _targetObjects != null && imageList.selectedItem != null)
				{
					(_targetObjects[0] as LinkableHashMap).removeObject(imageList.selectedItem as String);
					(_targetObjects[0] as LinkableHashMap).triggerCallbacks();
					imageList.dataProvider = (_targetObjects[0] as LinkableHashMap).getNames();
				}
			}
			
			protected function removeAllImagesButton(event:MouseEvent):void
			{
				//If it hasn't been already cleared, clear all of the objects.
				if( _targetObjects != null )
				{
					(_targetObjects[0] as LinkableHashMap).removeAllObjects();
					(_targetObjects[0] as LinkableHashMap).triggerCallbacks();
					imageList.dataProvider = null;
				}
			}
			
			protected function openNodeGroupSettings(event:MouseEvent):void
			{
				//Panel for the node group settings.
				var settingsPanel:NodeGroupSettingsPanel = DraggablePanel.openStaticInstance(NodeGroupSettingsPanel);
				settingsPanel.targets = [(_targetObjects[0] as LinkableHashMap).getObject(imageList.selectedItem as String)];
			}
			
		]]>
	</mx:Script>
</ui:ControlPanel>
